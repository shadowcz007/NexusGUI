<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIÁºñÁ®ãËÆ≠ÁªÉËê•ËØæÁ®ãÊó•ÂéÜ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .controls {
            background: #f8f9fa;
            padding: 25px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-group label {
            font-weight: 600;
            color: #495057;
            font-size: 1.1em;
        }

        .control-group input, .control-group select {
            padding: 10px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .control-group input:focus, .control-group select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn.danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }

        .btn.danger:hover {
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
        }

        .legend {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 20px;
            margin: 0 30px;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .legend-color.course {
            background: linear-gradient(135deg, #10ac84 0%, #1dd1a1 100%);
            color: white;
        }

        .legend-color.user {
            background: linear-gradient(135deg, #a55eea 0%, #8e44ad 100%);
            color: white;
        }

        .legend-color.today {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
        }

        .legend-color.selected {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .course-schedule {
            background: #e8f5e8;
            border: 1px solid #c3e6c3;
            padding: 20px;
            margin: 20px 30px;
            border-radius: 10px;
        }

        .course-schedule h3 {
            color: #2d5a2d;
            margin-bottom: 15px;
            text-align: center;
        }

        .course-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 10px;
        }

        .course-item {
            background: rgba(255, 255, 255, 0.7);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9em;
            display: flex;
            justify-content: space-between;
        }

        .calendar-container {
            padding: 30px;
            min-height: 400px;
        }

        .calendar-grid {
            display: grid;
            gap: 30px;
            justify-content: center;
        }

        .calendar-grid.cols-1 { grid-template-columns: 1fr; }
        .calendar-grid.cols-2 { grid-template-columns: repeat(2, 1fr); }
        .calendar-grid.cols-3 { grid-template-columns: repeat(3, 1fr); }
        .calendar-grid.cols-4 { grid-template-columns: repeat(4, 1fr); }
        .calendar-grid.cols-6 { grid-template-columns: repeat(3, 1fr); }
        .calendar-grid.cols-12 { grid-template-columns: repeat(4, 1fr); }

        @media (max-width: 1200px) {
            .calendar-grid.cols-4, .calendar-grid.cols-6, .calendar-grid.cols-12 {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 900px) {
            .calendar-grid {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }

        @media (max-width: 600px) {
            .calendar-grid {
                grid-template-columns: 1fr !important;
            }
        }

        .month-calendar {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease forwards;
            opacity: 0;
            transform: translateY(30px);
        }

        .month-calendar:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .month-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1.3em;
            font-weight: 700;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .weekday {
            padding: 15px 5px;
            text-align: center;
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
        }

        .day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #f1f3f4;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            position: relative;
        }

        .day:hover {
            background: #e3f2fd;
            color: #1976d2;
            transform: scale(1.05);
        }

        .day.other-month {
            color: #adb5bd;
            background: #f8f9fa;
        }

        .day.today {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }

        .day.selected {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            font-weight: 700;
        }

        .day.course-date {
            background: linear-gradient(135deg, #10ac84 0%, #1dd1a1 100%);
            color: white;
            font-weight: 700;
            position: relative;
        }

        .day.course-date::after {
            content: 'üìö';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
        }

        .day.user-marked {
            background: linear-gradient(135deg, #a55eea 0%, #8e44ad 100%);
            color: white;
            font-weight: 700;
            position: relative;
        }

        .day.user-marked::after {
            content: 'üìå';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #6c757d;
            font-size: 1.2em;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status-info {
            background: #e8f5e8;
            border: 1px solid #c3e6c3;
            color: #2d5a2d;
            padding: 15px;
            margin: 20px 30px;
            border-radius: 8px;
            font-weight: 500;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üóìÔ∏è AIÁºñÁ®ãËÆ≠ÁªÉËê•ËØæÁ®ãÊó•ÂéÜ</h1>
            <p>ÁÇπÂáªÊó•ÊúüËøõË°åÊ†áËÆ∞ÔºåÁªøËâ≤‰∏∫ËØæÁ®ãÊó•ÊúüÔºåÁ¥´Ëâ≤‰∏∫Áî®Êà∑Ê†áËÆ∞</p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="monthCount">ÊòæÁ§∫Êúà‰ªΩÊï∞:</label>
                <select id="monthCount">
                    <option value="1">1‰∏™Êúà</option>
                    <option value="2">2‰∏™Êúà</option>
                    <option value="3" selected>3‰∏™Êúà</option>
                    <option value="4">4‰∏™Êúà</option>
                    <option value="6">6‰∏™Êúà</option>
                    <option value="12">12‰∏™Êúà</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="startYear">Ëµ∑ÂßãÂπ¥‰ªΩ:</label>
                <input type="number" id="startYear" min="2020" max="2030" value="2024">
            </div>
            
            <div class="control-group">
                <label for="startMonth">Ëµ∑ÂßãÊúà‰ªΩ:</label>
                <select id="startMonth">
                    <option value="0">1Êúà</option>
                    <option value="1">2Êúà</option>
                    <option value="2">3Êúà</option>
                    <option value="3">4Êúà</option>
                    <option value="4">5Êúà</option>
                    <option value="5">6Êúà</option>
                    <option value="6">7Êúà</option>
                    <option value="7">8Êúà</option>
                    <option value="8" selected>9Êúà</option>
                    <option value="9">10Êúà</option>
                    <option value="10">11Êúà</option>
                    <option value="11">12Êúà</option>
                </select>
            </div>
            
            <button class="btn" onclick="updateCalendar()">üîÑ Êõ¥Êñ∞Êó•ÂéÜ</button>
            <button class="btn danger" onclick="clearAllMarks()">üßπ Ê∏ÖÈô§Ê†áËÆ∞</button>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color course">üìö</div>
                <span>ËØæÁ®ãÊó•Êúü</span>
            </div>
            <div class="legend-item">
                <div class="legend-color user">üìå</div>
                <span>Áî®Êà∑Ê†áËÆ∞</span>
            </div>
            <div class="legend-item">
                <div class="legend-color today">üìÖ</div>
                <span>‰ªäÂ§©</span>
            </div>
            <div class="legend-item">
                <div class="legend-color selected">‚ú®</div>
                <span>ÈÄâ‰∏≠Êó•Êúü</span>
            </div>
        </div>
        
        <div class="course-schedule">
            <h3>üìö AIÁºñÁ®ãËÆ≠ÁªÉËê•ËØæÁ®ãÂÆâÊéí (ÂÖ±10ËäÇËØæ)</h3>
            <div class="course-list">
                <div class="course-item"><span>Á¨¨1ËØæ: 9Êúà17Êó•</span><span>20:00-21:30</span></div>
                <div class="course-item"><span>Á¨¨2ËØæ: 9Êúà20Êó•</span><span>20:00-21:30</span></div>
                <div class="course-item"><span>Á¨¨3ËØæ: 9Êúà24Êó•</span><span>20:00-21:30</span></div>
                <div class="course-item"><span>Á¨¨4ËØæ: 9Êúà27Êó•</span><span>20:00-21:30</span></div>
                <div class="course-item"><span>Á¨¨5ËØæ: 10Êúà1Êó•</span><span>20:00-21:30</span></div>
                <div class="course-item"><span>Á¨¨6ËØæ: 10Êúà4Êó•</span><span>20:00-21:30</span></div>
                <div class="course-item"><span>Á¨¨7ËØæ: 10Êúà8Êó•</span><span>20:00-21:30</span></div>
                <div class="course-item"><span>Á¨¨8ËØæ: 10Êúà11Êó•</span><span>20:00-21:30</span></div>
                <div class="course-item"><span>Á¨¨9ËØæ: 10Êúà15Êó•</span><span>20:00-21:30</span></div>
                <div class="course-item"><span>Á¨¨10ËØæ: 10Êúà18Êó•</span><span>20:00-21:30</span></div>
            </div>
        </div>
        
        <div class="status-info" id="statusInfo">
            ÂΩìÂâçÊòæÁ§∫: 3‰∏™Êúà | ÊØèÊ¨°‰øÆÊîπÊúà‰ªΩÊï∞Êó∂ÔºåÊóßËßÜÂõæÂ∞ÜË¢´ÂÆåÂÖ®ÈîÄÊØÅÂπ∂ÈáçÊñ∞ÂàõÂª∫
        </div>
        
        <div class="calendar-container">
            <div id="calendarGrid" class="calendar-grid cols-3">
                <div class="loading">Ê≠£Âú®Âä†ËΩΩÊó•ÂéÜ...</div>
            </div>
        </div>
    </div>

    <script>
        // ËØæÁ®ãÊó•ÊúüÊï∞ÁªÑ (Êúà‰ªΩ‰ªé0ÂºÄÂßãÔºåÊâÄ‰ª•9ÊúàÊòØ8Ôºå10ÊúàÊòØ9)
        const courseDates = [
            { year: 2024, month: 8, day: 17, lesson: 'Á¨¨1ËØæ' },
            { year: 2024, month: 8, day: 20, lesson: 'Á¨¨2ËØæ' },
            { year: 2024, month: 8, day: 24, lesson: 'Á¨¨3ËØæ' },
            { year: 2024, month: 8, day: 27, lesson: 'Á¨¨4ËØæ' },
            { year: 2024, month: 9, day: 1, lesson: 'Á¨¨5ËØæ' },
            { year: 2024, month: 9, day: 4, lesson: 'Á¨¨6ËØæ' },
            { year: 2024, month: 9, day: 8, lesson: 'Á¨¨7ËØæ' },
            { year: 2024, month: 9, day: 11, lesson: 'Á¨¨8ËØæ' },
            { year: 2024, month: 9, day: 15, lesson: 'Á¨¨9ËØæ' },
            { year: 2024, month: 9, day: 18, lesson: 'Á¨¨10ËØæ' }
        ];

        // Áî®Êà∑Ê†áËÆ∞ÁÆ°ÁêÜÁ±ª
        class DateMarker {
            constructor() {
                this.markedDates = this.loadMarkedDates();
            }

            loadMarkedDates() {
                try {
                    const saved = localStorage.getItem('userMarkedDates');
                    return saved ? JSON.parse(saved) : [];
                } catch (e) {
                    console.error('Âä†ËΩΩÊ†áËÆ∞Êó•ÊúüÂ§±Ë¥•:', e);
                    return [];
                }
            }

            saveMarkedDates() {
                try {
                    localStorage.setItem('userMarkedDates', JSON.stringify(this.markedDates));
                    console.log('Ê†áËÆ∞Êó•ÊúüÂ∑≤‰øùÂ≠ò:', this.markedDates.length + '‰∏™');
                } catch (e) {
                    console.error('‰øùÂ≠òÊ†áËÆ∞Êó•ÊúüÂ§±Ë¥•:', e);
                }
            }

            isMarked(year, month, day) {
                return this.markedDates.some(date => 
                    date.year === year && date.month === month && date.day === day
                );
            }

            toggleMark(year, month, day) {
                const index = this.markedDates.findIndex(date => 
                    date.year === year && date.month === month && date.day === day
                );

                if (index >= 0) {
                    this.markedDates.splice(index, 1);
                    console.log('ÂèñÊ∂àÊ†áËÆ∞:', year + '-' + (month + 1) + '-' + day);
                    return false;
                } else {
                    this.markedDates.push({ year, month, day });
                    console.log('Ê∑ªÂä†Ê†áËÆ∞:', year + '-' + (month + 1) + '-' + day);
                    return true;
                }
            }

            clearAllMarks() {
                this.markedDates = [];
                this.saveMarkedDates();
                console.log('ÊâÄÊúâÊ†áËÆ∞Â∑≤Ê∏ÖÈô§');
            }

            getMarkedDates() {
                return this.markedDates;
            }
        }

        // ÂÖ®Â±ÄÂèòÈáè
        let currentCalendarInstance = null;
        const dateMarker = new DateMarker();
        
        // Êúà‰ªΩÂêçÁß∞
        const monthNames = [
            '‰∏ÄÊúà', '‰∫åÊúà', '‰∏âÊúà', 'ÂõõÊúà', '‰∫îÊúà', 'ÂÖ≠Êúà',
            '‰∏ÉÊúà', 'ÂÖ´Êúà', '‰πùÊúà', 'ÂçÅÊúà', 'ÂçÅ‰∏ÄÊúà', 'ÂçÅ‰∫åÊúà'
        ];
        
        // ÊòüÊúüÂêçÁß∞
        const weekdays = ['Êó•', '‰∏Ä', '‰∫å', '‰∏â', 'Âõõ', '‰∫î', 'ÂÖ≠'];

        // Â¢ûÂº∫ÁöÑÊó•ÂéÜÂÆû‰æãÁ±ª
        class EnhancedCalendarInstance {
            constructor(monthCount, startYear, startMonth) {
                this.monthCount = monthCount;
                this.startYear = startYear;
                this.startMonth = startMonth;
                this.data = [];
                this.isDestroyed = false;
                
                console.log('üìÖ ÂàõÂª∫Êñ∞ÁöÑÂ¢ûÂº∫Êó•ÂéÜÂÆû‰æã: ' + monthCount + '‰∏™Êúà, Ëµ∑Âßã: ' + startYear + 'Âπ¥' + (startMonth + 1) + 'Êúà');
                this.generateCalendarData();
            }
            
            generateCalendarData() {
                this.data = [];
                const today = new Date();
                
                for (let i = 0; i < this.monthCount; i++) {
                    const currentDate = new Date(this.startYear, this.startMonth + i, 1);
                    const year = currentDate.getFullYear();
                    const month = currentDate.getMonth();
                    
                    const firstDay = new Date(year, month, 1).getDay();
                    const daysInMonth = new Date(year, month + 1, 0).getDate();
                    const prevMonthDays = new Date(year, month, 0).getDate();
                    
                    const monthData = {
                        year,
                        month,
                        monthName: year + 'Âπ¥ ' + monthNames[month],
                        days: []
                    };
                    
                    // Ê∑ªÂä†‰∏ä‰∏™ÊúàÁöÑÊó•Êúü
                    for (let j = firstDay - 1; j >= 0; j--) {
                        monthData.days.push({
                            day: prevMonthDays - j,
                            year: month === 0 ? year - 1 : year,
                            month: month === 0 ? 11 : month - 1,
                            isCurrentMonth: false,
                            isToday: false,
                            isCourseDate: false,
                            isUserMarked: false
                        });
                    }
                    
                    // Ê∑ªÂä†ÂΩìÊúàÁöÑÊó•Êúü
                    for (let day = 1; day <= daysInMonth; day++) {
                        const isToday = today.getFullYear() === year && 
                                       today.getMonth() === month && 
                                       today.getDate() === day;
                        
                        // Ê£ÄÊü•ÊòØÂê¶ÊòØËØæÁ®ãÊó•Êúü
                        const courseInfo = courseDates.find(course => 
                            course.year === year && course.month === month && course.day === day
                        );
                        
                        // Ê£ÄÊü•ÊòØÂê¶ÊòØÁî®Êà∑Ê†áËÆ∞Êó•Êúü
                        const isUserMarked = dateMarker.isMarked(year, month, day);
                        
                        monthData.days.push({
                            day,
                            year,
                            month,
                            isCurrentMonth: true,
                            isToday,
                            isCourseDate: !!courseInfo,
                            courseInfo: courseInfo || null,
                            isUserMarked
                        });
                    }
                    
                    // Ê∑ªÂä†‰∏ã‰∏™ÊúàÁöÑÊó•Êúü
                    const remainingDays = 42 - monthData.days.length;
                    for (let day = 1; day <= remainingDays; day++) {
                        monthData.days.push({
                            day,
                            year: month === 11 ? year + 1 : year,
                            month: month === 11 ? 0 : month + 1,
                            isCurrentMonth: false,
                            isToday: false,
                            isCourseDate: false,
                            isUserMarked: false
                        });
                    }
                    
                    this.data.push(monthData);
                }
                
                console.log('‚úÖ Â¢ûÂº∫Êó•ÂéÜÊï∞ÊçÆÁîüÊàêÂÆåÊàê: ' + this.data.length + '‰∏™Êúà‰ªΩ');
            }
            
            render() {
                if (this.isDestroyed) {
                    console.warn('‚ö†Ô∏è Â∞ùËØïÊ∏≤ÊüìÂ∑≤ÈîÄÊØÅÁöÑÊó•ÂéÜÂÆû‰æã');
                    return;
                }
                
                const container = document.getElementById('calendarGrid');
                container.className = 'calendar-grid cols-' + this.monthCount;
                container.innerHTML = '';
                
                this.data.forEach((monthData, index) => {
                    const monthElement = this.createMonthElement(monthData, index);
                    container.appendChild(monthElement);
                });
                
                console.log('üé® Â¢ûÂº∫Êó•ÂéÜÊ∏≤ÊüìÂÆåÊàê: ' + this.data.length + '‰∏™Êúà‰ªΩ');
            }
            
            createMonthElement(monthData, index) {
                const monthDiv = document.createElement('div');
                monthDiv.className = 'month-calendar';
                monthDiv.style.animationDelay = (index * 0.1) + 's';
                
                const header = document.createElement('div');
                header.className = 'month-header';
                header.textContent = monthData.monthName;
                monthDiv.appendChild(header);
                
                const weekdaysDiv = document.createElement('div');
                weekdaysDiv.className = 'weekdays';
                weekdays.forEach(function(day) {
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'weekday';
                    dayDiv.textContent = day;
                    weekdaysDiv.appendChild(dayDiv);
                });
                monthDiv.appendChild(weekdaysDiv);
                
                const daysDiv = document.createElement('div');
                daysDiv.className = 'days';
                
                monthData.days.forEach(function(dayData) {
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'day';
                    dayDiv.textContent = dayData.day;
                    
                    if (!dayData.isCurrentMonth) {
                        dayDiv.classList.add('other-month');
                    }
                    
                    if (dayData.isToday) {
                        dayDiv.classList.add('today');
                    }
                    
                    if (dayData.isCourseDate) {
                        dayDiv.classList.add('course-date');
                        dayDiv.setAttribute('data-lesson', dayData.courseInfo.lesson);
                        dayDiv.title = dayData.courseInfo.lesson + ' - ' + (dayData.month + 1) + 'Êúà' + dayData.day + 'Êó• 20:00-21:30';
                    } else if (dayData.isUserMarked) {
                        dayDiv.classList.add('user-marked');
                        dayDiv.title = 'Áî®Êà∑Ê†áËÆ∞Êó•Êúü - ÁÇπÂáªÂèñÊ∂àÊ†áËÆ∞';
                    } else if (dayData.isCurrentMonth) {
                        dayDiv.title = 'ÁÇπÂáªÊ†áËÆ∞Ê≠§Êó•Êúü';
                    }
                    
                    dayDiv.addEventListener('click', function() {
                        document.querySelectorAll('.day.selected').forEach(function(el) {
                            el.classList.remove('selected');
                        });
                        
                        if (dayData.isCurrentMonth) {
                            dayDiv.classList.add('selected');
                            
                            if (dayData.isCourseDate) {
                                console.log('üìö ÈÄâ‰∏≠ËØæÁ®ãÊó•Êúü: ' + dayData.courseInfo.lesson);
                                const statusInfo = document.getElementById('statusInfo');
                                statusInfo.textContent = 'Â∑≤ÈÄâ‰∏≠ËØæÁ®ã: ' + dayData.courseInfo.lesson + ' - ' + (dayData.month + 1) + 'Êúà' + dayData.day + 'Êó• 20:00-21:30';
                                statusInfo.style.background = '#fef3c7';
                                statusInfo.style.borderColor = '#fbbf24';
                                statusInfo.style.color = '#92400e';
                            } else {
                                const wasMarked = dateMarker.toggleMark(dayData.year, dayData.month, dayData.day);
                                dateMarker.saveMarkedDates();
                                
                                if (wasMarked) {
                                    dayDiv.classList.add('user-marked');
                                    dayDiv.title = 'Áî®Êà∑Ê†áËÆ∞Êó•Êúü - ÁÇπÂáªÂèñÊ∂àÊ†áËÆ∞';
                                    dayData.isUserMarked = true;
                                } else {
                                    dayDiv.classList.remove('user-marked');
                                    dayDiv.title = 'ÁÇπÂáªÊ†áËÆ∞Ê≠§Êó•Êúü';
                                    dayData.isUserMarked = false;
                                }
                                
                                updateStatusInfo();
                            }
                        }
                    });
                    
                    daysDiv.appendChild(dayDiv);
                });
                
                monthDiv.appendChild(daysDiv);
                return monthDiv;
            }
            
            destroy() {
                if (this.isDestroyed) {
                    return;
                }
                
                console.log('üóëÔ∏è ÈîÄÊØÅÂ¢ûÂº∫Êó•ÂéÜÂÆû‰æã: ' + this.monthCount + '‰∏™Êúà');
                this.data = [];
                
                const container = document.getElementById('calendarGrid');
                if (container) {
                    container.innerHTML = '<div class="loading">Ê≠£Âú®ÈîÄÊØÅÊóßËßÜÂõæ...</div>';
                }
                
                this.isDestroyed = true;
                console.log('‚úÖ Â¢ûÂº∫Êó•ÂéÜÂÆû‰æãÂ∑≤ÂÆåÂÖ®ÈîÄÊØÅ');
            }
        }

        // Êõ¥Êñ∞Áä∂ÊÄÅ‰ø°ÊÅØ
        function updateStatusInfo() {
            const statusInfo = document.getElementById('statusInfo');
            const markedCount = dateMarker.getMarkedDates().length;
            const monthCount = parseInt(document.getElementById('monthCount').value);
            const startYear = parseInt(document.getElementById('startYear').value);
            const startMonth = parseInt(document.getElementById('startMonth').value);
            
            statusInfo.textContent = 'ÂΩìÂâçÊòæÁ§∫: ' + monthCount + '‰∏™Êúà | Ëµ∑Âßã: ' + startYear + 'Âπ¥' + (startMonth + 1) + 'Êúà | ËØæÁ®ãÊó•Êúü: 10‰∏™ | Áî®Êà∑Ê†áËÆ∞: ' + markedCount + '‰∏™';
            statusInfo.style.background = '#e8f5e8';
            statusInfo.style.borderColor = '#c3e6c3';
            statusInfo.style.color = '#2d5a2d';
        }

        // ÂÖ®Â±ÄÊõ¥Êñ∞Êó•ÂéÜÂáΩÊï∞
        function updateCalendar() {
            const monthCount = parseInt(document.getElementById('monthCount').value);
            const startYear = parseInt(document.getElementById('startYear').value);
            const startMonth = parseInt(document.getElementById('startMonth').value);
            
            console.log('üîÑ ÂºÄÂßãÊõ¥Êñ∞Â¢ûÂº∫Êó•ÂéÜ...');
            
            if (currentCalendarInstance) {
                currentCalendarInstance.destroy();
                currentCalendarInstance = null;
            }
            
            const container = document.getElementById('calendarGrid');
            container.innerHTML = '<div class="loading">Ê≠£Âú®ÂàõÂª∫Êñ∞ÁöÑÂ¢ûÂº∫Êó•ÂéÜËßÜÂõæ...</div>';
            
            const statusInfo = document.getElementById('statusInfo');
            const markedCount = dateMarker.getMarkedDates().length;
            statusInfo.textContent = 'Ê≠£Âú®ÂàõÂª∫: ' + monthCount + '‰∏™Êúà | ÊóßËßÜÂõæÂ∑≤ÂÆåÂÖ®ÈîÄÊØÅÔºåÊñ∞ËßÜÂõæÊ≠£Âú®ÁîüÊàê... | Â∑≤Ê†áËÆ∞ ' + markedCount + ' ‰∏™Êó•Êúü';
            statusInfo.style.background = '#e8f5e8';
            statusInfo.style.borderColor = '#c3e6c3';
            statusInfo.style.color = '#2d5a2d';
            
            setTimeout(function() {
                currentCalendarInstance = new EnhancedCalendarInstance(monthCount, startYear, startMonth);
                currentCalendarInstance.render();
                updateStatusInfo();
                console.log('‚úÖ Â¢ûÂº∫Êó•ÂéÜÊõ¥Êñ∞ÂÆåÊàê');
            }, 500);
        }

        // Ê∏ÖÈô§ÊâÄÊúâÊ†áËÆ∞ÂáΩÊï∞
        function clearAllMarks() {
            if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÊ†áËÆ∞ÁöÑÊó•ÊúüÂêóÔºü')) {
                dateMarker.clearAllMarks();
                updateCalendar();
            }
        }

        // ‰∫ã‰ª∂ÁõëÂê¨Âô®
        document.getElementById('monthCount').addEventListener('change', function() {
            console.log('üìä Êúà‰ªΩÊï∞Â∑≤Êõ¥Êîπ‰∏∫: ' + this.value);
            updateCalendar();
        });

        document.getElementById('startYear').addEventListener('change', updateCalendar);
        document.getElementById('startMonth').addEventListener('change', updateCalendar);

        // ÈîÆÁõòÂø´Êç∑ÈîÆ
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case '1':
                        document.getElementById('monthCount').value = '1';
                        updateCalendar();
                        e.preventDefault();
                        break;
                    case '2':
                        document.getElementById('monthCount').value = '2';
                        updateCalendar();
                        e.preventDefault();
                        break;
                    case '3':
                        document.getElementById('monthCount').value = '3';
                        updateCalendar();
                        e.preventDefault();
                        break;
                }
            }
        });

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ AIÁºñÁ®ãËÆ≠ÁªÉËê•ËØæÁ®ãÊó•ÂéÜÁ≥ªÁªüÂä†ËΩΩÂÆåÊàêÔºÅ');
            updateCalendar();
        });

        console.log('üìå ÂäüËÉΩËØ¥Êòé:');
        console.log('  ‚úÖ ÁÇπÂáª‰ªªÊÑèÊó•ÊúüËøõË°åÊ†áËÆ∞/ÂèñÊ∂àÊ†áËÆ∞');
        console.log('  ‚úÖ Á¥´Ëâ≤ËÉåÊôØ + üìåÂõæÊ†á = Áî®Êà∑Ê†áËÆ∞Êó•Êúü');
        console.log('  ‚úÖ ÁªøËâ≤ËÉåÊôØ + üìöÂõæÊ†á = ËØæÁ®ãÊó•Êúü');
        console.log('  ‚úÖ Ê†áËÆ∞Êï∞ÊçÆËá™Âä®‰øùÂ≠òÂà∞localStorage');
        console.log('  ‚úÖ ÊîØÊåÅÊ∏ÖÈô§ÊâÄÊúâÊ†áËÆ∞ÂäüËÉΩ');
        console.log('  ‚úÖ ÂÆåÂÖ®ÈîÄÊØÅÈáçÂª∫Êú∫Âà∂');
        console.log('  ‚úÖ ÈîÆÁõòÂø´Êç∑ÈîÆ: Ctrl+1/2/3 Âø´ÈÄüÂàáÊç¢Êúà‰ªΩÊï∞');
    </script>
</body>
</html>
