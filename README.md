# NexusGUI

é€šè¿‡ MCP ä¼ é€’ GUI å®šä¹‰ï¼Œå®ç° AI ç”Ÿæˆç•Œé¢ï¼Œæ¡Œé¢ç«¯æ¸²æŸ“

## ğŸ†• æœ€æ–°åŠŸèƒ½

### HTML ç›´æ¥æ¸²æŸ“æ¨¡å¼ ğŸ†•
- âœ… æ”¯æŒç›´æ¥ä¼ å…¥ HTML å­—ç¬¦ä¸²è¿›è¡Œç•Œé¢æ¸²æŸ“
- âœ… å®Œå…¨è‡ªå®šä¹‰çš„ç•Œé¢å¸ƒå±€å’Œæ ·å¼
- âœ… æ”¯æŒ JavaScript äº‹ä»¶å¤„ç†å’Œäº¤äº’
- âœ… ä¸ç»„ä»¶æ¨¡å¼å¹¶å­˜ï¼Œæä¾›æœ€å¤§çµæ´»æ€§

### çª—å£å¤ç”¨åŠŸèƒ½ ğŸ†•
- âœ… æ”¯æŒå¤ç”¨ç°æœ‰çª—å£è€Œä¸æ˜¯é”€æ¯é‡å»º
- âœ… é€šè¿‡ `reuseWindow` å‚æ•°æ§åˆ¶çª—å£å¤ç”¨è¡Œä¸º
- âœ… ä¿æŒçª—å£çŠ¶æ€å’Œä½ç½®ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- âœ… å‡å°‘èµ„æºæ¶ˆè€—ï¼Œæé«˜æ€§èƒ½

### çª—å£å±æ€§è®¾ç½®
- âœ… æ”¯æŒä¸°å¯Œçš„çª—å£å±æ€§é…ç½®ï¼ˆèœå•æ ã€è¾¹æ¡†ã€é€æ˜åº¦ã€å…¨å±ç­‰ï¼‰
- âœ… è¯¦ç»†çš„ç³»ç»ŸçŠ¶æ€æ˜¾ç¤ºï¼ˆMCPæœåŠ¡å™¨åœ°å€ã€ç«¯ç‚¹ä¿¡æ¯ç­‰ï¼‰
- âœ… å‘åå…¼å®¹ï¼Œæ‰€æœ‰ç°æœ‰åŠŸèƒ½ä¿æŒä¸å˜

è¯¦ç»†æ–‡æ¡£è¯·æŸ¥çœ‹ï¼š[WINDOW_PROPERTIES.md](./WINDOW_PROPERTIES.md) å’Œ [WINDOW_REUSE.md](./WINDOW_REUSE.md)

## é¡¹ç›®ç»“æ„

```
NexusGUI/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main/              # ä¸»è¿›ç¨‹ä»£ç 
â”‚   â”‚   â”œâ”€â”€ main.js        # Electron ä¸»è¿›ç¨‹
â”‚   â”‚   â””â”€â”€ preload.js     # é¢„åŠ è½½è„šæœ¬
â”‚   â”œâ”€â”€ renderer/          # æ¸²æŸ“è¿›ç¨‹ä»£ç 
â”‚   â”‚   â”œâ”€â”€ renderer.js    # åŠ¨æ€ç•Œé¢æ¸²æŸ“å™¨
â”‚   â”‚   â”œâ”€â”€ index.html     # ä¸»ç•Œé¢ HTML
â”‚   â”‚   â””â”€â”€ styles.css     # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ mcp/               # MCP æœåŠ¡å™¨ä»£ç 
â”‚       â”œâ”€â”€ sse/           # SSE ä¼ è¾“ç›¸å…³
â”‚       â”‚   â”œâ”€â”€ server.js  # SSE MCP æœåŠ¡å™¨
â”‚       â”‚   â”œâ”€â”€ wrapper.js # SSE æœåŠ¡å™¨åŒ…è£…å™¨
â”‚       â”‚   â””â”€â”€ transport.js # SSE ä¼ è¾“å±‚
â”‚       â””â”€â”€ stdio/         # æ ‡å‡†ä¼ è¾“ç›¸å…³ï¼ˆå¤‡ç”¨ï¼‰
â”‚           â”œâ”€â”€ server.mjs # æ ‡å‡† MCP æœåŠ¡å™¨
â”‚           â””â”€â”€ wrapper.js # æ ‡å‡†æœåŠ¡å™¨åŒ…è£…å™¨
â”œâ”€â”€ test/                  # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ setup.js          # æµ‹è¯•ç¯å¢ƒè®¾ç½®
â”‚   â””â”€â”€ renderer.test.js  # æ¸²æŸ“å™¨æµ‹è¯•
â”œâ”€â”€ tools/                 # å·¥å…·å’Œè°ƒè¯•
â”‚   â”œâ”€â”€ diagnose.js       # è¯Šæ–­å·¥å…·
â”‚   â””â”€â”€ test-debug.js     # æµ‹è¯•è°ƒè¯•è„šæœ¬
â”œâ”€â”€ package.json          # é¡¹ç›®é…ç½®
â”œâ”€â”€ jest.config.js        # Jest æµ‹è¯•é…ç½®
â””â”€â”€ README.md            # é¡¹ç›®è¯´æ˜
```

## æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒæ–‡ä»¶
- **`src/main/main.js`**: Electron ä¸»è¿›ç¨‹ï¼Œè´Ÿè´£çª—å£ç®¡ç†å’Œ MCP æœåŠ¡å™¨é›†æˆ
- **`src/main/preload.js`**: é¢„åŠ è½½è„šæœ¬ï¼Œæä¾›å®‰å…¨çš„ IPC é€šä¿¡æ¥å£
- **`src/renderer/renderer.js`**: åŠ¨æ€ç•Œé¢æ¸²æŸ“å™¨ï¼Œæ¥æ”¶ GUI å®šä¹‰å¹¶åˆ›å»ºç•Œé¢
- **`src/renderer/index.html`**: ä¸»ç•Œé¢ HTML æ¨¡æ¿
- **`src/renderer/styles.css`**: ç•Œé¢æ ·å¼æ–‡ä»¶

### MCP æœåŠ¡å™¨
- **`src/mcp/sse/server.js`**: SSE ä¼ è¾“çš„ MCP æœåŠ¡å™¨ï¼ˆä¸»è¦ä½¿ç”¨ï¼‰
- **`src/mcp/sse/wrapper.js`**: SSE æœåŠ¡å™¨åŒ…è£…å™¨
- **`src/mcp/sse/transport.js`**: SSE ä¼ è¾“å±‚å®ç°
- **`src/mcp/stdio/server.mjs`**: æ ‡å‡†ä¼ è¾“çš„ MCP æœåŠ¡å™¨ï¼ˆå¤‡ç”¨ï¼‰
- **`src/mcp/stdio/wrapper.js`**: æ ‡å‡†æœåŠ¡å™¨åŒ…è£…å™¨

### æµ‹è¯•å’Œå·¥å…·
- **`test/`**: Jest æµ‹è¯•æ–‡ä»¶
- **`tools/diagnose.js`**: ç³»ç»Ÿè¯Šæ–­å·¥å…·
- **`tools/test-debug.js`**: æœåŠ¡å™¨æµ‹è¯•è°ƒè¯•è„šæœ¬

## å¯åŠ¨æ–¹å¼

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm start

# è¿è¡Œæµ‹è¯•
npm test

# å¯åŠ¨è¯Šæ–­å·¥å…·
node tools/diagnose.js

# å¯åŠ¨ SSE æœåŠ¡å™¨æµ‹è¯•
node tools/test-debug.js

# å¯åŠ¨ HTML GUI æ¼”ç¤º
node demo-html-gui.js

# å¯åŠ¨çª—å£å¤ç”¨åŠŸèƒ½æµ‹è¯•
node test-window-reuse.js

# å¯åŠ¨çª—å£å¤ç”¨åŠŸèƒ½æ¼”ç¤º
node demo-window-reuse.js

# éªŒè¯çª—å£å¤ç”¨åŠŸèƒ½å®ç°
node verify-window-reuse.js
```

## çª—å£å¤ç”¨åŠŸèƒ½

### åŸºæœ¬ç”¨æ³•

```javascript
// å¤ç”¨ç°æœ‰çª—å£
{
  "title": "å¤ç”¨çš„çª—å£",
  "width": 800,
  "height": 600,
  "reuseWindow": true,  // å…³é”®å‚æ•°ï¼šå¯ç”¨çª—å£å¤ç”¨
  "components": [
    { "type": "heading", "text": "å¤ç”¨çš„çª—å£", "level": 1 },
    { "type": "text", "text": "è¿™ä¸ªçª—å£å¤ç”¨äº†ä¹‹å‰çš„çª—å£" },
    { "type": "button", "text": "ç‚¹å‡»æˆ‘", "onClick": "handleClick" }
  ],
  "callbacks": {
    "handleClick": "alert('å¤ç”¨çª—å£çš„æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼');"
  }
}
```

### çª—å£å¤ç”¨ vs æ–°å»ºçª—å£

```javascript
// æ–¹å¼ 1: åˆ›å»ºæ–°çª—å£ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰
{
  "title": "æ–°çª—å£",
  "reuseWindow": false,  // æˆ–ä¸è®¾ç½®æ­¤å‚æ•°
  "components": [...]
}

// æ–¹å¼ 2: å¤ç”¨ç°æœ‰çª—å£
{
  "title": "å¤ç”¨çª—å£",
  "reuseWindow": true,   // å¯ç”¨å¤ç”¨
  "components": [...]
}
```

### å¤ç”¨çª—å£çš„ä¼˜åŠ¿

- **ä¿æŒçª—å£ä½ç½®**: çª—å£ä¸ä¼šé‡æ–°å®šä½åˆ°å±å¹•ä¸­å¤®
- **ä¿æŒçª—å£å¤§å°**: å¦‚æœæ–°é…ç½®æ²¡æœ‰æŒ‡å®šå°ºå¯¸ï¼Œä¿æŒåŸæœ‰å°ºå¯¸
- **å‡å°‘é—ªçƒ**: é¿å…çª—å£å…³é—­å’Œé‡æ–°åˆ›å»ºçš„è¿‡ç¨‹
- **æå‡æ€§èƒ½**: å‡å°‘èµ„æºæ¶ˆè€—å’Œåˆå§‹åŒ–æ—¶é—´
- **æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ**: çª—å£çŠ¶æ€ä¿æŒè¿ç»­

## HTML æ¨¡å¼ä½¿ç”¨

### åŸºæœ¬ç”¨æ³•

```javascript
// é€šè¿‡ MCP è°ƒç”¨ render-gui å·¥å…·
{
  "title": "HTML ç•Œé¢ç¤ºä¾‹",
  "width": 800,
  "height": 600,
  "html": `
    <div style="padding: 20px;">
      <h1>Hello World</h1>
      <p>è¿™æ˜¯ä¸€ä¸ª HTML ç•Œé¢</p>
      <button onclick="alert('ç‚¹å‡»äº†æŒ‰é’®')">ç‚¹å‡»æˆ‘</button>
    </div>
  `
}
```

### é«˜çº§åŠŸèƒ½

```javascript
{
  "title": "å¤æ‚ HTML ç•Œé¢",
  "html": `
    <div style="padding: 20px; font-family: Arial, sans-serif;">
      <h1 style="color: #333;">å¤æ‚ç•Œé¢ç¤ºä¾‹</h1>
      
      <form id="myForm">
        <input type="text" name="username" placeholder="ç”¨æˆ·å">
        <button type="submit">æäº¤</button>
      </form>
      
      <div id="result"></div>
    </div>
  `,
  "callbacks": {
    "handleSubmit": `
      const formData = getFormData('#myForm');
      sendResult({ action: 'submit', data: formData });
    `
  }
}
```

### åŠŸèƒ½ç‰¹ç‚¹

- **å®Œæ•´ HTML æ”¯æŒ**: æ”¯æŒæ‰€æœ‰ HTML æ ‡ç­¾å’Œå±æ€§
- **CSS æ ·å¼**: æ”¯æŒå†…è”æ ·å¼å’Œå¤–éƒ¨ CSS
- **JavaScript äº¤äº’**: æ”¯æŒäº‹ä»¶å¤„ç†å’ŒåŠ¨æ€äº¤äº’
- **è¡¨å•å¤„ç†**: è‡ªåŠ¨æä¾› `getFormData()` å‡½æ•°
- **å›è°ƒå‡½æ•°**: æ”¯æŒè‡ªå®šä¹‰å›è°ƒå‡½æ•°æ³¨å…¥
- **æ•°æ®ç»‘å®š**: æ”¯æŒåˆå§‹æ•°æ®æ³¨å…¥

## æŠ€æœ¯æ ˆ

- **Electron**: æ¡Œé¢åº”ç”¨æ¡†æ¶
- **Model Context Protocol (MCP)**: AI é€šä¿¡åè®®
- **Server-Sent Events (SSE)**: å®æ—¶é€šä¿¡
- **Jest**: æµ‹è¯•æ¡†æ¶
